import{_ as yt}from"./D5C0Ey2G.js";import{ac as ct,d as R,ad as ft,ae as M,af as xt,ag as vt,r as $,o as gt,ah as wt,q as kt,v as E,n as A,ai as bt,aj as It,a3 as St,I as Ct,m as Dt,p as Ft,D as C,M as rt,V as Bt,a6 as Ot,u as Tt,s as Pt,L as Lt,c as h,b,e as l,k as v,j as s,t as y,g as w,i as N,f as O,w as T,C as Nt}from"./CHxXT5wL.js";import{M as it,a as P,b as dt,e as L}from"./CJUpyWK0.js";import{c as j}from"./D67sP_7a.js";import"./Ivdj-dxv.js";const pt={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},jt={ariaLabel:{type:String},ariaDescribedby:{type:String}},Mt={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...pt,...jt},$t=vt[0]==="2"?(n,r)=>Object.assign(n,{attrs:r}):(n,r)=>Object.assign(n,r);function D(n){return bt(n)?E(n):n}function Et(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return bt(r)?new Proxy(n,{}):n}function At(n,r){const g=n.options;g&&r&&Object.assign(g,r)}function mt(n,r){n.labels=r}function _t(n,r,g){const m=[];n.datasets=r.map(t=>{const u=n.datasets.find(_=>_[g]===t[g]);return!u||!t.data||m.includes(u)?{...t}:(m.push(u),Object.assign(u,t),u)})}function Rt(n,r){const g={labels:[],datasets:[]};return mt(g,n.labels),_t(g,n.datasets,r),g}const Vt=R({props:Mt,setup(n,r){let{expose:g,slots:m}=r;const t=$(null),u=ft(null);g({chart:u});const _=()=>{if(!t.value)return;const{type:p,data:k,options:e,plugins:a,datasetIdKey:i}=n,f=Rt(k,i),o=Et(f,k);u.value=new ct(t.value,{type:p,data:o,options:{...e},plugins:a})},x=()=>{const p=E(u.value);p&&(n.destroyDelay>0?setTimeout(()=>{p.destroy(),u.value=null},n.destroyDelay):(p.destroy(),u.value=null))},F=p=>{p.update(n.updateMode)};return gt(_),wt(x),kt([()=>n.options,()=>n.data],(p,k)=>{let[e,a]=p,[i,f]=k;const o=E(u.value);if(!o)return;let d=!1;if(e){const c=D(e),I=D(i);c&&c!==I&&(At(o,c),d=!0)}if(a){const c=D(a.labels),I=D(f.labels),S=D(a.datasets),B=D(f.datasets);c!==I&&(mt(o.config.data,c),d=!0),S&&S!==B&&(_t(o.config.data,S,n.datasetIdKey),d=!0)}d&&A(()=>{F(o)})},{deep:!0}),()=>M("canvas",{role:"img",ariaLabel:n.ariaLabel,ariaDescribedby:n.ariaDescribedby,ref:t},[M("p",{},[m.default?m.default():""])])}});function ht(n,r){return ct.register(r),R({props:pt,setup(g,m){let{expose:t}=m;const u=ft(null),_=x=>{u.value=x==null?void 0:x.chart};return t({chart:u}),()=>M(Vt,$t({ref:_},{type:n,...g}))}})}const ut=ht("bar",It),qt=ht("line",xt),zt={class:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8"},Kt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mb-6"},Ut={key:0,class:"flex justify-between items-center"},Yt={class:"flex flex-col"},Gt={class:"text-lg font-medium"},Ht={class:"text-lg font-medium mt-2"},Wt={class:"flex flex-col"},Jt={class:"flex flex-col items-end font-bold"},Qt={key:0,class:"text-lg"},Xt={key:0},Zt={class:"text-gray-500 dark:text-gray-400"},te={key:1},ee={class:"flex flex-col items-end font-bold"},ae={key:0,class:"text-lg mt-2"},se={key:0},ne={class:"text-gray-500 dark:text-gray-400"},oe={key:1},le={class:"mt-3"},re={class:"text-gray-500 dark:text-gray-400 text-sm"},ie={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg mb-6 p-4 w-full"},de={class:"w-full overflow-x-auto overflow-hidden"},ue={class:"min-w-[640px]"},ce={key:0},fe={class:"w-full overflow-x-auto overflow-hidden"},ge={class:"min-w-[640px]"},be={class:"w-full overflow-x-auto overflow-hidden"},pe={class:"min-w-[640px]"},me={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mt-6 grid grid-cols-2 gap-2"},we=R({__name:"charts",setup(n){const r=St(),g=Ct(),m=Dt("warn_unsaved",()=>!1),t=Ft(new it(-1,-1,-1,[],[],!1,!1)),u=$(void 0),_=$(0),x=j(async()=>{var i;_.value;let e={labels:[],datasets:[]};if(e.labels=[],e.datasets=[],!t.FirstInning)return e;let a=await L(C,t.FirstInning);for(;e.labels.length<a.length;)e.labels.push((e.labels.length+1).toString());e.datasets.push({label:`${(i=t.team1)==null?void 0:i.name}`,data:[],borderColor:"#36A2EB",backgroundColor:"#9BD0F5"});for(let f of a){let o=0;for(let d of f.balls)o+=d.runs_by_running+d.boundary,d.legal||o++;e.datasets[0].data.push(o)}return e}),F=j(async()=>{var i;_.value;let e={labels:[],datasets:[]};if(e.labels=[],e.datasets=[],!t.SecondInning)return e;let a=await L(C,t.SecondInning);for(;e.labels.length<a.length;)e.labels.push((e.labels.length+1).toString());e.datasets.push({label:`${(i=t.team2)==null?void 0:i.name}`,data:[],borderColor:"#FF6384",backgroundColor:"#FFB1C1"});for(let f of a){let o=0;for(let d of f.balls)o+=d.runs_by_running+d.boundary,d.legal||o++;e.datasets[0].data.push(o)}return e}),p=j(async()=>{var a,i;_.value;let e={labels:[],datasets:[]};if(e.labels=[],e.datasets=[],t.FirstInning){let f=await L(C,t.FirstInning);for(;e.labels.length<f.length;)e.labels.push((e.labels.length+1).toString());e.datasets.push({label:`${(a=t.team1)==null?void 0:a.name}`,data:[],borderColor:"#36A2EB",backgroundColor:"#9BD0F5"});let o=0;for(let d of f){for(let c of d.balls)o+=c.runs_by_running+c.boundary,c.legal||o++;e.datasets[0].data.push(o)}}if(t.SecondInning){let f=await L(C,t.SecondInning);for(;e.labels.length<f.length;)e.labels.push((e.labels.length+1).toString());e.datasets.push({label:`${(i=t.team2)==null?void 0:i.name}`,data:[],borderColor:"#FF6384",backgroundColor:"#FFB1C1"});let o=0;for(let d of f){for(let c of d.balls)o+=c.runs_by_running+c.boundary,c.legal||o++;e.datasets[1].data.push(o)}}return e});async function k(){await Nt("Warning","Are you sure you want to delete this match?")&&(m.value=!0,await A(),await t.delete_self(),m.value=!1,g.push("/"))}return gt(async()=>{var a,i;let e=(await C.select().from(rt).where(Bt(rt.id,parseInt(r.params.id))))[0];if(e===void 0)throw Ot({fatal:!0,statusCode:404});Object.assign(t,it.from_drizzle(e)),await t.load_data(C),_.value++,t.SecondInning?u.value=t.SecondInning:t.FirstInning&&(u.value=t.FirstInning),Tt({title:`Charts - ${(a=t.team1)==null?void 0:a.name} vs ${(i=t.team2)==null?void 0:i.name} - CRK2`}),await A(),Pt(!1)}),(e,a)=>{var o,d,c,I,S,B,V,q,z,K,U,Y,G,H,W,J,Q,X,Z,tt,et,at,st,nt,ot,lt;const i=yt,f=Lt("Button");return b(),h("div",zt,[l("div",Kt,[s(t)?(b(),h("div",Ut,[l("div",Yt,[l("span",Gt,y((d=(o=s(t))==null?void 0:o.team1)==null?void 0:d.name),1),l("span",Ht,y((I=(c=s(t))==null?void 0:c.team2)==null?void 0:I.name),1)]),l("div",Wt,[l("div",Jt,[((S=s(t))==null?void 0:S.Status)!=s(P).NOT_STARTED?(b(),h("span",Qt,[w(y((V=(B=s(t))==null?void 0:B.FirstInning)==null?void 0:V.runs),1),((z=(q=s(t))==null?void 0:q.FirstInning)==null?void 0:z.id_YetToBat.length)!=0||s(t).FirstInning.id_striker!=-1&&s(t).FirstInning.id_non_striker!=-1?(b(),h("span",Xt,"/"+y((U=(K=s(t))==null?void 0:K.FirstInning)==null?void 0:U.wickets),1)):v("",!0),a[0]||(a[0]=w("   ")),l("span",Zt,"("+y(s(dt)((Y=s(t))==null?void 0:Y.FirstInning.balls))+")",1)])):(b(),h("span",te," "))]),l("div",ee,[[s(P).SECOND_INNING,s(P).COMPLETED].includes((G=s(t))==null?void 0:G.Status)?(b(),h("span",ae,[w(y((W=(H=s(t))==null?void 0:H.SecondInning)==null?void 0:W.runs),1),((Q=(J=s(t))==null?void 0:J.SecondInning)==null?void 0:Q.id_YetToBat.length)!=0||((X=s(t))==null?void 0:X.SecondInning.id_striker)!=-1&&((Z=s(t))==null?void 0:Z.SecondInning.id_non_striker)!=-1?(b(),h("span",se,"/"+y((et=(tt=s(t))==null?void 0:tt.SecondInning)==null?void 0:et.wickets),1)):v("",!0),a[1]||(a[1]=w("   ")),l("span",ne,"("+y(s(dt)((at=s(t))==null?void 0:at.SecondInning.balls))+")",1)])):(b(),h("span",oe," "))])])])):v("",!0),l("div",le,[l("span",re,y((st=s(t))==null?void 0:st.StatusMessage),1)])]),s(t).Status!=s(P).NOT_STARTED?(b(),h("div",ie,[a[3]||(a[3]=l("div",{class:"text-gray-500 dark:text-gray-400 text-sm md:hidden mb-4"},"For better experience on mobile devices, please view in landscape mode.",-1)),a[4]||(a[4]=l("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"First Innings",-1)),l("div",de,[l("div",ue,[s(x)?(b(),N(s(ut),{key:0,data:s(x)},null,8,["data"])):v("",!0)])]),s(t).SecondInning?(b(),h("div",ce,[a[2]||(a[2]=l("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Second Innings",-1)),l("div",fe,[l("div",ge,[s(F)?(b(),N(s(ut),{key:0,data:s(F)},null,8,["data"])):v("",!0)])])])):v("",!0),a[5]||(a[5]=l("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Runs Comparison",-1)),l("div",be,[l("div",pe,[s(p)?(b(),N(s(qt),{key:0,data:s(p)},null,8,["data"])):v("",!0)])])])):v("",!0),l("div",me,[O(i,{to:`/match/${(nt=s(t))==null?void 0:nt.id}`,class:"flex items-center bg-pink-500 dark:bg-pink-600 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:T(()=>a[6]||(a[6]=[w("Controls")])),_:1,__:[6]},8,["to"]),O(i,{to:`/match/${(ot=s(t))==null?void 0:ot.id}/scoreboard`,class:"flex items-center bg-green-500 dark:bg-green-600 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:T(()=>a[7]||(a[7]=[w("Scoreboard")])),_:1,__:[7]},8,["to"]),O(i,{to:`/match/${(lt=s(t))==null?void 0:lt.id}/timeline`,class:"flex items-center bg-indigo-500 dark:bg-indigo-600 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:T(()=>a[8]||(a[8]=[w("Timeline")])),_:1,__:[8]},8,["to"]),O(f,{class:"flex items-center bg-red-500 dark:bg-red-600 text-white font-bold py-2 px-4 rounded w-full justify-center",onClick:k},{default:T(()=>a[9]||(a[9]=[w("Delete")])),_:1,__:[9]})])])}}});export{we as default};
