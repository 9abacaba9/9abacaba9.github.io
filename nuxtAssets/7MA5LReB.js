import{d as H,aa as W,I as K,m as O,r as b,J as U,p as q,o as J,D as h,K as y,V as w,a6 as X,u as F,U as p,W as T,n as f,s as G,L as Q,c as i,b as n,e as t,t as r,j as a,f as c,_ as Y,g as l,w as x,k as Z,A as z,C as ee,ab as te,M as I,X as se,R as N}from"./dVWTdz__.js";import{_ as j}from"./CmPQ7Mzi.js";import{T as ae}from"./CcTuiQ7E.js";const oe={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},re={class:"px-4 py-6 sm:px-0"},de={class:"flex justify-between items-center mb-6"},ie={class:"text-3xl font-semibold mr-6"},ne={class:"flex gap-2 items-center"},le=["disabled"],ce=["disabled"],ge={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6"},me={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},ue={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},_e={class:"text-2xl font-bold text-gray-900 dark:text-white"},he={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},xe={class:"text-2xl font-bold text-gray-900 dark:text-white"},we={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},ye={class:"text-2xl font-bold text-gray-900 dark:text-white"},pe={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},fe={class:"text-2xl font-bold text-gray-900 dark:text-white"},ve={class:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},be={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},ke={key:0,class:"font-medium text-gray-900 dark:text-white"},De={key:1,class:"font-medium text-gray-900 dark:text-white"},Ie={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ce={key:0,class:"font-medium text-gray-900 dark:text-white"},Te={key:1,class:"font-medium text-gray-900 dark:text-white"},ze={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ne={key:0,class:"font-medium text-gray-900 dark:text-white"},je={key:1,class:"font-medium text-gray-900 dark:text-white"},Pe={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Be={key:0,class:"font-medium text-gray-900 dark:text-white"},Ve={key:1,class:"font-medium text-gray-900 dark:text-white"},$e={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ee={key:0,class:"font-medium text-gray-900 dark:text-white"},Re={key:1,class:"font-medium text-gray-900 dark:text-white"},Se={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ae={key:0,class:"font-medium text-gray-900 dark:text-white"},Le={key:1,class:"font-medium text-gray-900 dark:text-white"},Me={class:"mb-6 flex gap-2"},He=["disabled"],We={class:"bg-white dark:bg-gray-800 shadow overflow-hidden rounded-md"},Ke={class:"px-6 py-4 flex items-center justify-between gap-1"},Oe={class:"text-gray-400 mr-3 font-semibold"},Ue={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},Ge=H({__name:"index",setup(qe){const P=W(),B=K(),u=O("warn_unsaved",()=>!1),o=b(void 0),g=b([]);async function V(){var m;if(!((m=o.value)!=null&&m.id))return;let d=await z("Add New Player","New Player Name","Add Player");if(!d.trim())return;u.value=!0,await f();const e=T.from_drizzle((await h.insert(p).values({name:d.trim(),teamID:o.value.id,order:g.value.length}).returning())[0]);g.value.push(e),u.value=!1}const $=U(()=>{for(let d=0;d<g.value.length;d++)if(d!=g.value[d].order)return!0;return!1}),k=b(!1);async function E(){var d;if((d=o.value)!=null&&d.id){u.value=!0,await f(),k.value=!0;for(let e=0;e<g.value.length;e++)e!=g.value[e].order&&(await h.update(p).set({order:e}).where(w(p.id,g.value[e].id)),g.value[e].order=e);k.value=!1,u.value=!1}}async function R(){var e;if(!((e=o.value)!=null&&e.id))return;let d=await z("Edit Team","Enter New Team Name","Edit Team",o.value.name);d.trim()&&(u.value=!0,await f(),await h.update(y).set({name:d.trim()}).where(w(y.id,o.value.id)),o.value.name=d.trim(),u.value=!1)}const D=b(!1);async function S(){var m;if(!((m=o.value)!=null&&m.id))return;D.value=!0;const d=await ee("Warning","Are you sure you want to delete this team?");let e=!1;if(d){const{match_count:_}=(await h.select({match_count:te()}).from(I).where(se(w(I.team1ID,o.value.id),w(I.team2ID,o.value.id))))[0];_>0?N("Error","This team has matches. Please delete the matches first."):g.value.length>0?N("Error","This team has players. Please delete the players first."):(u.value=!0,await f(),await h.delete(y).where(w(y.id,o.value.id)),e=!0,u.value=!1)}D.value=!1,e&&B.push("/teams")}const s=q({matches:0,wins:0,losses:0,nr:0,highest_score:{runs:0,wickets:0,matchID:-1,opponent:""},lowest_score:{runs:0,wickets:0,matchID:-1,opponent:""},biggest_win_runs:{diff:0,matchID:-1,opponent:""},biggest_win_wickets:{wickets:0,matchID:-1,opponent:""},highest_chased:{runs:0,wickets:0,matchID:-1,opponent:""},lowest_defended:{target:0,matchID:-1,opponent:""}});return J(async()=>{let d=parseInt(P.params.id);if(o.value=ae.from_drizzle((await h.select().from(y).where(w(y.id,d)))[0]),!o.value)throw X({fatal:!0,statusCode:404,message:"No such team"});o.value.setDB(h),F({title:`Team ${o.value.name} - CRK2`}),g.value=(await h.select().from(p).where(w(p.teamID,o.value.id)).orderBy(p.order).all()).map(e=>T.from_drizzle(e)),Object.assign(s,{matches:await o.value.get_match_count(),wins:await o.value.get_match_wins(),losses:await o.value.get_match_losses(),highest_score:await o.value.get_highest_score(),lowest_score:await o.value.get_lowest_score(),biggest_win_runs:await o.value.biggest_win_by_runs(),biggest_win_wickets:await o.value.biggest_win_by_wickets(),highest_chased:await o.value.highest_runs_chased(),lowest_defended:await o.value.lowest_runs_defended()}),s.nr=s.matches-s.wins-s.losses,await f(),G(!1)}),(d,e)=>{var C;const m=Y,_=j,A=j,L=Q("draggable");return n(),i("div",oe,[t("div",re,[t("div",de,[t("h1",ie,r((C=o.value)==null?void 0:C.name),1),t("div",ne,[t("button",{onClick:R,disabled:a(u),class:"flex items-center bg-green-600 hover:bg-green-700 text-white font-bold p-2 rounded",title:"edit"},[c(m,{name:"majesticons:edit-pen-2"})],8,le),t("button",{onClick:S,disabled:D.value,class:"flex items-center bg-red-600 hover:bg-red-700 text-white font-bold p-2 rounded",title:"delete"},[c(m,{name:"majesticons:delete-bin"})],8,ce)])]),t("div",ge,[e[11]||(e[11]=t("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Team Statistics",-1)),t("div",me,[t("div",ue,[e[1]||(e[1]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Matches",-1)),t("p",_e,r(a(s).matches),1)]),t("div",he,[e[2]||(e[2]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Wins",-1)),t("p",xe,r(a(s).wins),1)]),t("div",we,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Losses",-1)),t("p",ye,r(a(s).losses),1)]),t("div",pe,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Ties/No Results",-1)),t("p",fe,r(a(s).nr),1)])]),t("div",ve,[t("div",be,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Highest Score",-1)),a(s).highest_score?(n(),i("p",ke,[l(r(a(s).highest_score.runs)+"/"+r(a(s).highest_score.wickets)+" ",1),c(_,{to:`/match/${a(s).highest_score.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).highest_score.opponent),1)]),_:1},8,["to"])])):(n(),i("p",De,"-"))]),t("div",Ie,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Lowest Score",-1)),a(s).lowest_score?(n(),i("p",Ce,[l(r(a(s).lowest_score.runs)+"/"+r(a(s).lowest_score.wickets)+" ",1),c(_,{to:`/match/${a(s).lowest_score.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).lowest_score.opponent),1)]),_:1},8,["to"])])):(n(),i("p",Te,"-"))]),t("div",ze,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Biggest win by runs",-1)),a(s).biggest_win_runs?(n(),i("p",Ne,[l(r(a(s).biggest_win_runs.diff)+" runs ",1),c(_,{to:`/match/${a(s).biggest_win_runs.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).lowest_score.opponent),1)]),_:1},8,["to"])])):(n(),i("p",je,"-"))]),t("div",Pe,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Biggest win by wickets",-1)),a(s).biggest_win_wickets?(n(),i("p",Be,[l(r(a(s).biggest_win_wickets.wickets)+" wickets ",1),c(_,{to:`/match/${a(s).biggest_win_wickets.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).biggest_win_wickets.opponent),1)]),_:1},8,["to"])])):(n(),i("p",Ve,"-"))]),t("div",$e,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Highest Runs Chased",-1)),a(s).highest_chased?(n(),i("p",Ee,[l(r(a(s).highest_chased.runs)+"/"+r(a(s).highest_chased.wickets)+" ",1),c(_,{to:`/match/${a(s).highest_chased.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).highest_chased.opponent),1)]),_:1},8,["to"])])):(n(),i("p",Re,"-"))]),t("div",Se,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Lowest Runs Defended",-1)),a(s).lowest_defended?(n(),i("p",Ae,[l(r(a(s).lowest_defended.target)+" ",1),c(_,{to:`/match/${a(s).lowest_defended.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[l(" vs "+r(a(s).lowest_defended.opponent),1)]),_:1},8,["to"])])):(n(),i("p",Le,"-"))])])]),t("div",Me,[t("button",{onClick:V,class:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex items-center",title:"add player"},[c(m,{name:"majesticons:plus",class:"mr-1"}),e[12]||(e[12]=l(" Add Player "))]),$.value?(n(),i("button",{key:0,disabled:k.value,onClick:E,class:"flex items-center bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",title:"save order"},[c(m,{name:"majesticons:save",class:"mr-1"}),e[13]||(e[13]=l(" Saver Order "))],8,He)):Z("",!0)]),t("div",We,[c(L,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=v=>g.value=v),handle:".handle","ghost-class":"opacity-50",class:"divide-y divide-gray-200 dark:divide-gray-700"},{item:x(({element:v,index:M})=>[t("div",Ke,[c(A,{to:`/player/${v.id}`,class:"flex items-center flex-grow"},{default:x(()=>[t("span",Oe,r(M+1)+".",1),t("span",Ue,r(v.name),1)]),_:2},1032,["to"]),c(m,{name:"majesticons:menu",size:"1.5rem",class:"handle"})])]),_:1},8,["modelValue"])])])])}}});export{Ge as default};
