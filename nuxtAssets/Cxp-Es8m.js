import{d as V,ab as R,z as L,A as H,r as p,K as z,D as K,o as M,E as O,u as W,n as w,s as G,G as U,c as n,a as l,b as t,t as r,i as a,e as g,_ as q,f as c,w as x,j as F,a3 as k,ac as J,H as Q,a2 as D}from"./BftIUcDm.js";import{_ as I}from"./BqSKh5cC.js";import{D as m}from"./Bcq5nZh3.js";const X={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},Y={class:"px-4 py-6 sm:px-0"},Z={class:"flex justify-between items-center mb-6"},ee={class:"text-3xl font-semibold mr-6"},te={class:"flex gap-2 items-center"},se=["disabled"],ae=["disabled"],oe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6"},re={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},de={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},ie={class:"text-2xl font-bold text-gray-900 dark:text-white"},ne={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},le={class:"text-2xl font-bold text-gray-900 dark:text-white"},ce={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},ge={class:"text-2xl font-bold text-gray-900 dark:text-white"},ue={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center"},me={class:"text-2xl font-bold text-gray-900 dark:text-white"},_e={class:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},he={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},xe={key:0,class:"font-medium text-gray-900 dark:text-white"},we={key:1,class:"font-medium text-gray-900 dark:text-white"},ye={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},pe={key:0,class:"font-medium text-gray-900 dark:text-white"},fe={key:1,class:"font-medium text-gray-900 dark:text-white"},ve={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},be={key:0,class:"font-medium text-gray-900 dark:text-white"},ke={key:1,class:"font-medium text-gray-900 dark:text-white"},De={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ie={key:0,class:"font-medium text-gray-900 dark:text-white"},Ce={key:1,class:"font-medium text-gray-900 dark:text-white"},Ne={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Te={key:0,class:"font-medium text-gray-900 dark:text-white"},je={key:1,class:"font-medium text-gray-900 dark:text-white"},Ae={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},Ee={key:0,class:"font-medium text-gray-900 dark:text-white"},Pe={key:1,class:"font-medium text-gray-900 dark:text-white"},$e={class:"mb-6 flex gap-2"},Be=["disabled"],Se={class:"bg-white dark:bg-gray-800 shadow overflow-hidden rounded-md"},Ve={class:"px-6 py-4 flex items-center justify-between gap-1"},Re={class:"text-gray-400 mr-3 font-semibold"},Le={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},Oe=V({__name:"index",setup(He){const C=R(),N=L(),_=H("warn_unsaved",()=>!1),o=p(void 0),i=p([]);async function T(){var e;if(!((e=o.value)!=null&&e.id))return;let d=await k("Add New Player","New Player Name","Add Player");d.trim()&&(_.value=!0,await w(),await m.player.add(new J(d.trim(),o.value.id,i.value.length)),i.value=await m.player.where({teamID:o.value.id}).toArray(),i.value.sort((u,h)=>u.order-h.order),_.value=!1)}const j=z(()=>{for(let d=0;d<i.value.length;d++)if(d!=i.value[d].order)return!0;return!1}),f=p(!1);async function A(){var d;if((d=o.value)!=null&&d.id){_.value=!0,await w(),f.value=!0;for(let e=0;e<i.value.length;e++)e!=i.value[e].order&&(await m.player.update(i.value[e].id,{order:e}),i.value[e].order=e);f.value=!1,_.value=!1}}async function E(){var e;if(!((e=o.value)!=null&&e.id))return;let d=await k("Edit Team","Enter New Team Name","Edit Team",o.value.name);d.trim()&&(_.value=!0,await w(),await m.team.update(o.value.id,{name:d.trim()}),o.value.name=d.trim(),_.value=!1)}const v=p(!1);async function P(){var u;if(!((u=o.value)!=null&&u.id))return;v.value=!0;const d=await Q("Warning","Are you sure you want to delete this team?");let e=!1;d&&(await m.match.where({team1ID:o.value.id}).count()+await m.match.where({team2ID:o.value.id}).count()>0?D("Error","This team has matches. Please delete the matches first."):i.value.length>0?D("Error","This team has players. Please delete the players first."):(_.value=!0,await w(),await m.team.delete(o.value.id),e=!0,_.value=!1)),v.value=!1,e&&N.push("/teams")}const s=K({matches:0,wins:0,losses:0,nr:0,highest_score:{runs:0,wickets:0,matchID:-1,opponent:""},lowest_score:{runs:0,wickets:0,matchID:-1,opponent:""},biggest_win_runs:{diff:0,matchID:-1,opponent:""},biggest_win_wickets:{wickets:0,matchID:-1,opponent:""},highest_chased:{runs:0,wickets:0,matchID:-1,opponent:""},lowest_defended:{target:0,matchID:-1,opponent:""}});return M(async()=>{let d=parseInt(C.params.id);if(o.value=await m.team.get(d),!o.value)throw O({fatal:!0,statusCode:404,message:"No such team"});o.value.setDB(m),W({title:`Team ${o.value.name} - CRK2`}),i.value=await m.player.where({teamID:o.value.id}).toArray(),i.value.sort((e,u)=>e.order-u.order),Object.assign(s,{matches:await o.value.get_match_count(),wins:await o.value.get_match_wins(),losses:await o.value.get_match_losses(),highest_score:await o.value.get_highest_score(),lowest_score:await o.value.get_lowest_score(),biggest_win_runs:await o.value.biggest_win_by_runs(),biggest_win_wickets:await o.value.biggest_win_by_wickets(),highest_chased:await o.value.highest_runs_chased(),lowest_defended:await o.value.lowest_runs_defended()}),s.nr=s.matches-s.wins-s.losses,await w(),G(!1)}),(d,e)=>{var b;const u=q,h=I,$=I,B=U("draggable");return l(),n("div",X,[t("div",Y,[t("div",Z,[t("h1",ee,r((b=o.value)==null?void 0:b.name),1),t("div",te,[t("button",{onClick:E,disabled:a(_),class:"flex items-center bg-green-600 hover:bg-green-700 text-white font-bold p-2 rounded",title:"edit"},[g(u,{name:"majesticons:edit-pen-2"})],8,se),t("button",{onClick:P,disabled:v.value,class:"flex items-center bg-red-600 hover:bg-red-700 text-white font-bold p-2 rounded",title:"delete"},[g(u,{name:"majesticons:delete-bin"})],8,ae)])]),t("div",oe,[e[11]||(e[11]=t("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Team Statistics",-1)),t("div",re,[t("div",de,[e[1]||(e[1]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Matches",-1)),t("p",ie,r(a(s).matches),1)]),t("div",ne,[e[2]||(e[2]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Wins",-1)),t("p",le,r(a(s).wins),1)]),t("div",ce,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Losses",-1)),t("p",ge,r(a(s).losses),1)]),t("div",ue,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Ties/No Results",-1)),t("p",me,r(a(s).nr),1)])]),t("div",_e,[t("div",he,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Highest Score",-1)),a(s).highest_score?(l(),n("p",xe,[c(r(a(s).highest_score.runs)+"/"+r(a(s).highest_score.wickets)+" ",1),g(h,{to:`/match/${a(s).highest_score.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).highest_score.opponent),1)]),_:1},8,["to"])])):(l(),n("p",we,"-"))]),t("div",ye,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Lowest Score",-1)),a(s).lowest_score?(l(),n("p",pe,[c(r(a(s).lowest_score.runs)+"/"+r(a(s).lowest_score.wickets)+" ",1),g(h,{to:`/match/${a(s).lowest_score.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).lowest_score.opponent),1)]),_:1},8,["to"])])):(l(),n("p",fe,"-"))]),t("div",ve,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Biggest win by runs",-1)),a(s).biggest_win_runs?(l(),n("p",be,[c(r(a(s).biggest_win_runs.diff)+" runs ",1),g(h,{to:`/match/${a(s).biggest_win_runs.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).lowest_score.opponent),1)]),_:1},8,["to"])])):(l(),n("p",ke,"-"))]),t("div",De,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Biggest win by wickets",-1)),a(s).biggest_win_wickets?(l(),n("p",Ie,[c(r(a(s).biggest_win_wickets.wickets)+" wickets ",1),g(h,{to:`/match/${a(s).biggest_win_wickets.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).biggest_win_wickets.opponent),1)]),_:1},8,["to"])])):(l(),n("p",Ce,"-"))]),t("div",Ne,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Highest Runs Chased",-1)),a(s).highest_chased?(l(),n("p",Te,[c(r(a(s).highest_chased.runs)+"/"+r(a(s).highest_chased.wickets)+" ",1),g(h,{to:`/match/${a(s).highest_chased.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).highest_chased.opponent),1)]),_:1},8,["to"])])):(l(),n("p",je,"-"))]),t("div",Ae,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-1"},"Lowest Runs Defended",-1)),a(s).lowest_defended?(l(),n("p",Ee,[c(r(a(s).lowest_defended.target)+" ",1),g(h,{to:`/match/${a(s).lowest_defended.matchID}/scoreboard`,class:"text-xs text-gray-500 dark:text-gray-400"},{default:x(()=>[c(" vs "+r(a(s).lowest_defended.opponent),1)]),_:1},8,["to"])])):(l(),n("p",Pe,"-"))])])]),t("div",$e,[t("button",{onClick:T,class:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex items-center",title:"add player"},[g(u,{name:"majesticons:plus",class:"mr-1"}),e[12]||(e[12]=c(" Add Player "))]),j.value?(l(),n("button",{key:0,disabled:f.value,onClick:A,class:"flex items-center bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",title:"save order"},[g(u,{name:"majesticons:save",class:"mr-1"}),e[13]||(e[13]=c(" Saver Order "))],8,Be)):F("",!0)]),t("div",Se,[g(B,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=y=>i.value=y),handle:".handle","ghost-class":"opacity-50",class:"divide-y divide-gray-200 dark:divide-gray-700"},{item:x(({element:y,index:S})=>[t("div",Ve,[g($,{to:`/player/${y.id}`,class:"flex items-center flex-grow"},{default:x(()=>[t("span",Re,r(S+1)+".",1),t("span",Le,r(y.name),1)]),_:2},1032,["to"]),g(u,{name:"majesticons:menu",size:"1.5rem",class:"handle"})])]),_:1},8,["modelValue"])])])])}}});export{Oe as default};
