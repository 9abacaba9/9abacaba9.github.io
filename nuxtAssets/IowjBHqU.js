import{_ as _t}from"./ZqKWvp-n.js";import{_ as mt}from"./D5C0Ey2G.js";import{d as ft,a3 as pt,I as xt,m as yt,p as bt,r as Z,o as ht,D as y,M as tt,V as kt,a6 as vt,u as wt,n as et,s as It,L as St,c as o,b as a,e as s,k as u,j as e,t as r,g as l,y as nt,F as st,h as at,i as Ct,f as _,w as m,C as Ft}from"./CHxXT5wL.js";import{M as ot,a as b,b as rt,e as Bt}from"./CJUpyWK0.js";import{c as Nt}from"./D67sP_7a.js";import"./Ivdj-dxv.js";const Tt={class:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8"},jt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mb-6"},Dt={key:0,class:"flex justify-between items-center"},Mt={class:"flex flex-col"},$t={class:"text-lg font-medium"},Et={class:"text-lg font-medium mt-2"},zt={class:"flex flex-col"},Lt={class:"flex flex-col items-end font-bold"},Ot={key:0,class:"text-lg"},Vt={key:0},Rt={class:"text-gray-500 dark:text-gray-400"},At={key:1},Yt={class:"flex flex-col items-end font-bold"},qt={key:0,class:"text-lg mt-2"},Gt={key:0},Ht={class:"text-gray-500 dark:text-gray-400"},Kt={key:1},Pt={class:"mt-3"},Wt={class:"text-gray-500 dark:text-gray-400 text-sm"},Jt={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg mb-6"},Qt={class:"border-b border-gray-200 dark:border-gray-700"},Ut={class:"flex -mb-px"},Xt={class:"grid grid-cols-1 gap-4 p-4"},Zt={class:"text-sm font-medium"},te={class:"mt-2 flex gap-2"},ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mt-6 grid grid-cols-2 gap-2"},le=ft({__name:"timeline",setup(ne){const it=pt(),dt=xt(),h=yt("warn_unsaved",()=>!1),t=bt(new ot(-1,-1,-1,[],[],!1,!1)),i=Z(void 0),f=Z(0),lt=Nt(async()=>{if(f.value,!!i.value)return await Bt(y,i.value)});function ct(g){let n=0;for(let d of g)n+=d.runs_by_running+d.boundary,d.legal||n++;return n}async function ut(){await Ft("Warning","Are you sure you want to delete this match?")&&(h.value=!0,await et(),await t.delete_self(),h.value=!1,dt.push("/"))}return ht(async()=>{var n,d;let g=(await y.select().from(tt).where(kt(tt.id,parseInt(it.params.id))))[0];if(g===void 0)throw vt({fatal:!0,statusCode:404});Object.assign(t,ot.from_drizzle(g)),await t.load_data(y),t.SecondInning?(i.value=t.SecondInning,f.value++):t.FirstInning&&(i.value=t.FirstInning,f.value++),wt({title:`Timeline - ${(n=t.team1)==null?void 0:n.name} vs ${(d=t.team2)==null?void 0:d.name} - CRK2`}),await et(),It(!1)}),(g,n)=>{var k,v,w,I,S,C,F,B,N,T,j,D,M,$,E,z,L,O,V,R,A,Y,q,G,H,K,P,W;const d=_t,p=mt,gt=St("Button");return a(),o("div",Tt,[s("div",jt,[e(t)?(a(),o("div",Dt,[s("div",Mt,[s("span",$t,r((v=(k=e(t))==null?void 0:k.team1)==null?void 0:v.name),1),s("span",Et,r((I=(w=e(t))==null?void 0:w.team2)==null?void 0:I.name),1)]),s("div",zt,[s("div",Lt,[((S=e(t))==null?void 0:S.Status)!=e(b).NOT_STARTED?(a(),o("span",Ot,[l(r((F=(C=e(t))==null?void 0:C.FirstInning)==null?void 0:F.runs),1),((N=(B=e(t))==null?void 0:B.FirstInning)==null?void 0:N.id_YetToBat.length)!=0||e(t).FirstInning.id_striker!=-1&&e(t).FirstInning.id_non_striker!=-1?(a(),o("span",Vt,"/"+r((j=(T=e(t))==null?void 0:T.FirstInning)==null?void 0:j.wickets),1)):u("",!0),n[2]||(n[2]=l("   ")),s("span",Rt,"("+r(e(rt)((D=e(t))==null?void 0:D.FirstInning.balls))+")",1)])):(a(),o("span",At," "))]),s("div",Yt,[[e(b).SECOND_INNING,e(b).COMPLETED].includes((M=e(t))==null?void 0:M.Status)?(a(),o("span",qt,[l(r((E=($=e(t))==null?void 0:$.SecondInning)==null?void 0:E.runs),1),((L=(z=e(t))==null?void 0:z.SecondInning)==null?void 0:L.id_YetToBat.length)!=0||((O=e(t))==null?void 0:O.SecondInning.id_striker)!=-1&&((V=e(t))==null?void 0:V.SecondInning.id_non_striker)!=-1?(a(),o("span",Gt,"/"+r((A=(R=e(t))==null?void 0:R.SecondInning)==null?void 0:A.wickets),1)):u("",!0),n[3]||(n[3]=l("   ")),s("span",Ht,"("+r(e(rt)((Y=e(t))==null?void 0:Y.SecondInning.balls))+")",1)])):(a(),o("span",Kt," "))])])])):u("",!0),s("div",Pt,[s("span",Wt,r((q=e(t))==null?void 0:q.StatusMessage),1)])]),e(i)!=null?(a(),o("div",Jt,[s("div",Qt,[s("nav",Ut,[(G=e(t))!=null&&G.FirstInning?(a(),o("button",{key:0,onClick:n[0]||(n[0]=c=>i.value=e(t).FirstInning),class:nt(["px-4 py-4 text-sm font-medium whitespace-nowrap",[e(i)===e(t).FirstInning?"border-b-2 border-indigo-500 text-indigo-600 dark:text-indigo-400":"text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"]])}," First Inning ",2)):u("",!0),(H=e(t))!=null&&H.SecondInning?(a(),o("button",{key:1,onClick:n[1]||(n[1]=c=>i.value=e(t).SecondInning),class:nt(["px-4 py-4 text-sm font-medium whitespace-nowrap",[e(i)===e(t).SecondInning?"border-b-2 border-indigo-500 text-indigo-600 dark:text-indigo-400":"text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"]])}," Second Inning ",2)):u("",!0)])]),s("div",Xt,[(a(!0),o(st,null,at(e(lt),(c,J)=>{var Q,U;return a(),o("div",{class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",key:J},[s("div",Zt," Over "+r(J+1)+": "+r((Q=e(t).player_by_id(c.bowler))==null?void 0:Q.name)+" to "+r(c.batters.map(x=>{var X;return(X=e(t).player_by_id(x))==null?void 0:X.name}).slice(0,-1).join(", ")+" and "+((U=e(t).player_by_id(c.batters.slice(-1)[0]))==null?void 0:U.name))+" ("+r(ct(c.balls))+" runs) ",1),s("div",te,[(a(!0),o(st,null,at(c.balls,x=>(a(),Ct(d,{ball:x},null,8,["ball"]))),256))])])}),128))])])):u("",!0),s("div",ee,[_(p,{to:`/match/${(K=e(t))==null?void 0:K.id}`,class:"flex items-center bg-pink-500 dark:bg-pink-600 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:m(()=>n[4]||(n[4]=[l("Controls")])),_:1,__:[4]},8,["to"]),_(p,{to:`/match/${(P=e(t))==null?void 0:P.id}/scoreboard`,class:"flex items-center bg-green-500 dark:bg-green-600 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:m(()=>n[5]||(n[5]=[l("Scoreboard")])),_:1,__:[5]},8,["to"]),_(p,{to:`/match/${(W=e(t))==null?void 0:W.id}/charts`,class:"flex items-center bg-yellow-400 dark:bg-yellow-500 text-white font-bold py-2 px-4 rounded w-full justify-center"},{default:m(()=>n[6]||(n[6]=[l("Charts")])),_:1,__:[6]},8,["to"]),_(gt,{class:"flex items-center bg-red-500 dark:bg-red-600 text-white font-bold py-2 px-4 rounded w-full justify-center",onClick:ut},{default:m(()=>n[7]||(n[7]=[l("Delete")])),_:1,__:[7]})])])}}});export{le as default};
