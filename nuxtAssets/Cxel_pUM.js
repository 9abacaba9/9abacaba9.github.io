import{_ as j}from"./CmPQ7Mzi.js";import{d as K,a3 as O,p as $,a5 as R,a9 as q,u as A,D as s,U as c,W as E,K as a,V as o,am as f,an as H,M as d,X as z,ao as U,ap as W,a7 as X,a8 as G,n as J,s as Q,c as _,b as I,e as m,t as h,j as g,k as T,F as Y,h as Z,f as F,w as S,g as B,y as ee}from"./dVWTdz__.js";const te={class:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8"},ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg mb-6 p-4"},ie={class:"text-xl font-bold"},ne={class:"overflow-x-auto"},se={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},le={class:"text-left text-xs font-medium text-gray-500 dark:text-gray-400 tracking-wider"},re={class:"py-2"},oe={class:"py-2 px-1 text-right"},me={key:0,class:"py-2 px-1 text-right"},de={class:"divide-y divide-gray-200 dark:divide-gray-700"},pe={class:"text-left py-2 pr-2 font-semibold align-top"},ce={class:"py-2"},ue={key:0,class:"text-gray-600 dark:text-gray-400 max-w-xs text-sm"},fe={key:0,class:"py-2 px-1 text-right align-top"},_e=K({__name:"[stat]",setup(ge){const M=O(),l=$({name:"",description:"",valueName:"",type:"",opponent:!1}),t=$([]);return R(async()=>{var v,w,p,y,N,P,C,V,L;const x=q.find(u=>u.name==M.params.stat);if(x&&Object.assign(l,x),A({title:l.description}),l.type!="team"&&!l.opponent){let u=(await s.select().from(c).all()).map(e=>E.from_drizzle(e));for(let e of u){e.setDB(s);let i=(await s.select({id:a.id,name:a.name}).from(a).where(o(a.id,e.teamID)))[0],n=await l.func(e);n=="-"||n=="0"||n=="0.0"||n=="0.00"||t.push({rank:1,name:e.name,id:e.id,value:n,team:i==null?void 0:i.name,teamId:i==null?void 0:i.id})}l.big_is_better?t.sort((e,i)=>parseFloat(i.value)-parseFloat(e.value)):t.sort((e,i)=>parseFloat(e.value)-parseFloat(i.value));for(let e=0;e<t.length;e++)t[e].value==((v=t[e-1])==null?void 0:v.value)?t[e].rank=t[e-1].rank:t[e].rank=e+1}else if(l.type=="team"){let u=(await s.select().from(f).all()).map(e=>H.from_drizzle(e));for(let e of u){await e.load_data(s);let i=l.funcInn(e);if(i=="-")continue;let n="",r="";l.battingSide?(n=(w=(await s.select({name:a.name}).from(a).where(o(a.id,e.battingTeamID)))[0])==null?void 0:w.name,r=(p=(await s.select({name:a.name}).from(a).where(o(a.id,e.bowlingTeamID)))[0])==null?void 0:p.name):(n=(y=(await s.select({name:a.name}).from(a).where(o(a.id,e.bowlingTeamID)))[0])==null?void 0:y.name,r=(N=(await s.select({name:a.name}).from(a).where(o(a.id,e.battingTeamID)))[0])==null?void 0:N.name),t.push({rank:1,name:n,id:l.battingSide?e.battingTeamID:e.bowlingTeamID,value:i,opponent:r,matchId:(P=(await s.select({id:d.id}).from(d).where(z(o(d.id_FirstInning,e.id),o(d.id_SecondInning,e.id))))[0])==null?void 0:P.id,wickets:e.wickets.toString()})}l.big_is_better?t.sort((e,i)=>parseFloat(i.value)-parseFloat(e.value)):t.sort((e,i)=>parseFloat(e.value)-parseFloat(i.value));for(let e=0;e<t.length;e++)t[e].value==((C=t[e-1])==null?void 0:C.value)?t[e].rank=t[e-1].rank:t[e].rank=e+1;if(["team-highest-runs","team-lowest-runs","team-highest-chase"].includes(l.name))for(let e=0;e<t.length;e++)t[e].value=t[e].value+"/"+t[e].wickets}else if(l.name=="high-scores"){let u=(await s.select().from(U).all()).map(e=>W.from_drizzle(e));for(let e of u){if(e.runs==0)continue;let i=(await s.select({id:c.id,name:c.name,teamID:c.teamID}).from(c).where(o(c.id,e.playerID)))[0],n=(await s.select({id:a.id,name:a.name}).from(a).where(o(a.id,i.teamID)))[0],r=(await s.select({id:f.id,bowlingTeamID:f.bowlingTeamID}).from(f).where(o(f.id,e.inningID)))[0],b=(await s.select({id:a.id,name:a.name}).from(a).where(o(a.id,r.bowlingTeamID)))[0],D=(await s.select({id:d.id}).from(d).where(z(o(d.id_FirstInning,r.id),o(d.id_SecondInning,r.id))))[0],k=e.runs.toString()+"/";e.outOnBall==-1&&(k+="*"),t.push({rank:1,name:i.name,id:i.id,value:k,team:n.name,teamId:n.id,opponent:b.name,matchId:D.id})}t.sort((e,i)=>{let n=e.value.split("/"),r=i.value.split("/");return n[0]==r[0]?r[1]=="*"?1:n[1]=="*"?-1:0:parseInt(r[0])-parseInt(n[0])});for(let e=0;e<t.length;e++)t[e].value==((V=t[e-1])==null?void 0:V.value)?t[e].rank=t[e-1].rank:t[e].rank=e+1,t[e].value=t[e].value.replace("/","")}else{let u=(await s.select().from(X).all()).map(e=>G.from_drizzle(e));for(let e of u){if(e.wickets==0)continue;let i=(await s.select({id:c.id,name:c.name,teamID:c.teamID}).from(c).where(o(c.id,e.playerID)))[0],n=(await s.select({id:a.id,name:a.name}).from(a).where(o(a.id,i.teamID)))[0],r=(await s.select({id:f.id,battingTeamID:f.battingTeamID}).from(f).where(o(f.id,e.inningID)))[0],b=(await s.select({id:a.id,name:a.name}).from(a).where(o(a.id,r.battingTeamID)))[0],D=(await s.select({id:d.id}).from(d).where(z(o(d.id_FirstInning,r.id),o(d.id_SecondInning,r.id))))[0],k=e.wickets.toString()+"/"+e.runs.toString();t.push({rank:1,name:i.name,id:i.id,value:k,team:n.name,teamId:n.id,opponent:b.name,matchId:D.id})}t.sort((e,i)=>{let n=e.value.split("/"),r=i.value.split("/");return n[0]==r[0]?parseInt(n[1])-parseInt(r[1]):parseInt(r[0])-parseInt(n[0])});for(let e=0;e<t.length;e++)t[e].value==((L=t[e-1])==null?void 0:L.value)?t[e].rank=t[e-1].rank:t[e].rank=e+1}await J(),Q(!1)}),(x,v)=>{const w=j;return I(),_("div",te,[m("div",ae,[m("h3",ie,h(g(l).description),1),m("div",ne,[m("table",se,[m("thead",null,[m("tr",le,[v[0]||(v[0]=m("th",{class:"py-2"},"#",-1)),m("th",re,h(g(l).type=="team"?"Team":"Player"),1),m("th",oe,h(g(l).valueName),1),g(l).opponent?(I(),_("th",me,"vs")):T("",!0)])]),m("tbody",de,[(I(!0),_(Y,null,Z(g(t),(p,y)=>(I(),_("tr",{key:y,class:"text-sm text-gray-900 dark:text-gray-100"},[m("td",pe,h(p.rank),1),m("td",ce,[m("div",null,[F(w,{to:`/${g(l).type=="team"?"teams":"player"}/${p.id}`,class:"font-medium"},{default:S(()=>[B(h(p.name),1)]),_:2},1032,["to"])]),g(l).type!="team"?(I(),_("div",ue,[F(w,{to:`/teams/${p.teamId}`},{default:S(()=>[B(h(p.team),1)]),_:2},1032,["to"])])):T("",!0)]),m("td",{class:ee(["py-2 font-bold text-right align-top",g(l).opponent?"":"text-lg"])},h(p.value),3),g(l).opponent?(I(),_("td",fe,[F(w,{to:`/match/${p.matchId}/scoreboard`},{default:S(()=>[B(h(p.opponent),1)]),_:2},1032,["to"])])):T("",!0)]))),128))])])])])])}}});export{_e as default};
